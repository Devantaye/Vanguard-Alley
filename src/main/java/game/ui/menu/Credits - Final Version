package com.example.gamemenu;

import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionListener;
import java.util.Arrays;
import java.util.List;

public class Credits extends JPanel 
{
    private JButton backButton;
    private Timer timer;

    // Phase control
    private boolean showThankYou = false;

    // Y offset for scrolling
    private int yOffset = -200; // start above screen

    private final List<String> creditsText = Arrays.asList //text for 
    (
            "Project Lead: Dr Xinyu Hu",
            "Hand Gesture Control: Shayne Muir and Yunsu Yeo",
            "Tank Game Creation: Devante Mika and Leo Milne",
            "Tank Game Menu Creation/Support: Weijian Wang and Kanak Nandal"
    );

    private final String header = "CREDITS";
    private final String thankYouMessage = "Thank you for playing!";

    public Credits(ActionListener onBack) 
    {
        setPreferredSize(new Dimension(800, 600));
        setLayout(null);

        // Back button
        backButton = new JButton("Back to Menu");
        backButton.setBounds(320, 500, 160, 40);
        backButton.addActionListener(onBack);
        add(backButton);

            // Animation timer
            // inside the Timer update
        timer = new Timer(33, e -> 
        {
            yOffset += 2; // move downward

        if (!showThankYou) 
        {
            // Total block height = header + credits lines
            int blockHeight = 60 + creditsText.size() * 40;

            // Bottom Y position of the block
            int blockBottom = yOffset + blockHeight;

            // Wait until the whole block is completely off-screen
            if (blockBottom > getHeight()) 
            {
                showThankYou = true;
                yOffset = -50; // restart above screen for thank-you message
            }
        } 
        else 
        {
            // Stop once thank-you message reaches center
            int panelCenter = getHeight() / 2;
            
            if (yOffset >= panelCenter) 
            {
                yOffset = panelCenter;
                timer.stop();
            }
        }

        repaint();
    });

        timer.start();
    }

    @Override
    protected void paintComponent(Graphics g) 
    {
        super.paintComponent(g);
        Graphics2D g2 = (Graphics2D) g;

        // Background - pitch black
        g2.setColor(Color.BLACK);
        g2.fillRect(0, 0, getWidth(), getHeight());

        if (!showThankYou) 
        {
            // Header (scrolling with credits)
            g2.setFont(new Font("Monospaced", Font.BOLD, 36));
            g2.setColor(Color.GREEN);
            FontMetrics fmHeader = g2.getFontMetrics();
            int headerX = (getWidth() - fmHeader.stringWidth(header)) / 2;
            g2.drawString(header, headerX, yOffset);

            // Credits text
            g2.setFont(new Font("Arial", Font.PLAIN, 18));
            g2.setColor(Color.RED);
            FontMetrics fmCredits = g2.getFontMetrics();

            int y = yOffset + 60; // leave some gap after header
            
            for (String line : creditsText) 
            {
                int textWidth = fmCredits.stringWidth(line);
                int x = (getWidth() - textWidth) / 2; // center horizontally
                g2.drawString(line, x, y);
                y += 40;
            }
        } 
        else 
        {
            // Thank You message
            g2.setFont(new Font("Arial", Font.BOLD, 24));
            g2.setColor(Color.YELLOW);
            FontMetrics fm2 = g2.getFontMetrics();
            int msgX = (getWidth() - fm2.stringWidth(thankYouMessage)) / 2;
            g2.drawString(thankYouMessage, msgX, yOffset);
        }
    }


    // For quick testing
    public static void main(String[] args) 
    {
        JFrame frame = new JFrame("Credits");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(new Credits(e -> System.out.println("Back clicked")));
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
}
